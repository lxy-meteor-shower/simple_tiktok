# 开发日志

## 客户端相关

首先分析了一些客户端的内容：

- 在未登录的情况下
    - 刚刚进入会有的请求：（刷视频也是）
        - Get feed
        - Get publish/list
        - Get favorite/list
    - 点击评论
        - Get comment/list
    - 登陆
        - Post user/login （进入个人主页）
    - 注册
        - Post user/register （进入个人主页）
- 在登陆的情况下
    - 刚刚进入：
        - ~~Get relation/friend/list~~ 
        - 其他同上
    - 进入个人主页
        - Get user （只有刚登陆时有，客户端应该有缓存）
        - Get publish/list
        - Get facorite/list
    - 点击点赞
        - Post favorite/action
    - 在评论输入内容
        - Post comment/action
    - 加号发布
        - Post publish/action

## 数据库

定下来是四个数据库

| 表名     | 描述                     | 备注                                               |
|----------|--------------------------|----------------------------------------------------|
| User     | 存储用户信息             | 用户登陆时需要查询用户名，可以按用户名建个索引     |
| Video    | 存储视频信息             | 可以按用户id和视频id建索引，用于查询用户发布的视频 |
| Favorite | 存储用户对视频的点赞记录 | 可以考虑存储时间，按时间罗列，一般按用户聚类查询   |
| Comment  | 存储用户对视频的评论记录 | 一般按视频聚类查询                                 |

## IDL

明确服务提供的请求

### user

在用户不存在时添加用户

检查用户的密码是否正确

获取用户的基本信息

某人被点赞加/减1

某人发布视频加1

某人点赞数加/减1

### Video

添加视频

获取用户发布的所有视频

获取视频流

获取指定id的视频

视频点赞数加/减1

视频评论数加/减1

### interact

增加一条点赞记录

删除一条点赞记录

获取用户点赞的所有视频

获取是否存在某条点赞记录

增加一条评论记录

删除一条评论记录

获取某视频的全部评论
